<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Password & Passkey Generator</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
  <div class="row">

    <!-- LEFT COLUMN -->
    <div class="col-md-5">

      <h2>Password Generator</h2>

      <!-- Password Form -->
      <form id="passwordForm" class="mb-4 text-left">

        <div class="form-row">
          <div class="col">
            <input type="number" class="form-control" name="howmanypasswords"
                   placeholder="How many passwords" min="1">
          </div>
          <div class="col">
            <input type="number" class="form-control" name="length"
                   placeholder="Password length" min="1">
          </div>
        </div>

        <div class="form-check mt-2">
          <input class="form-check-input" type="checkbox" name="uppercase" id="uppercase">
          <label class="form-check-label" for="uppercase">Include uppercase</label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="special" id="special">
          <label class="form-check-label" for="special">Include special characters</label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="numbers" id="numbers">
          <label class="form-check-label" for="numbers">Include numbers</label>
        </div>

        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="annoy" id="annoy">
          <label class="form-check-label" for="annoy">Include ambiguous characters</label>
        </div>

        <button class="btn btn-primary mt-3 w-100">
          Generate Passwords
        </button>
      </form>

      <hr>

      <!-- Passkey -->
      <h4>Passkey</h4>
      <form id="passkeyForm">
        <button class="btn btn-success w-100">
          Generate Passkey
        </button>
      </form>

    </div>

    <!-- RIGHT COLUMN -->
    <div class="col-md-7">
      <h2>Results</h2>

      <div id="results" class="border rounded p-3 bg-light" style="min-height: 200px;">
        <p class="text-muted">Generated passwords and passkeys will appear here.</p>
      </div>
    </div>

  </div>
</div>

<script>
const resultsDiv = document.getElementById("results");

// Password form submission
document.getElementById("passwordForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    resultsDiv.innerHTML = "Generating passwords...";

    const formData = Object.fromEntries(new FormData(e.target).entries());
    formData.action = "password";
    // Convert checkboxes to booleans
    formData.uppercase = formData.uppercase ? true : false;
    formData.special = formData.special ? true : false;
    formData.numbers = formData.numbers ? true : false;
    formData.annoy = formData.annoy ? true : false;

    const res = await fetch("/generate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData)
    });
    const data = await res.json();

    if (data.error) {
        resultsDiv.innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
        return;
    }

    resultsDiv.innerHTML = "<h3>Generated Passwords:</h3><ul>" +
        data.passwords.map(p => `<li>${p}</li>`).join("") +
        "</ul>";
});

// Passkey form submission
document.getElementById("passkeyForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    resultsDiv.innerHTML = "Generating passkey...";

    const res = await fetch("/generate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ action: "passkey" })
    });
    const data = await res.json();

    if (data.error) {
        resultsDiv.innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
        return;
    }

    resultsDiv.innerHTML = `<h3>Generated Passkey:</h3><p>${data.passkey}</p>`;
});
</script>
</body>
</html>
